---
title: "在Adobe啟動中實作Video Analytics"
description: 說明
solution: Customer Journey Analytics,Analytics
product: Customer Journey Analytics,Analytics
applies-to: "Customer Journey Analytics,Analytics"
keywords: "KCS Launch Video Analytics心率"
resolution: Resolution
internal-notes: "This implementation discussed in this article does not use Adobe Launch extension for Media Analytics."
bug: false
article-created-by: Krunal Oza
article-created-date: "9/16/2022 9:07:03 AM"
article-published-by: Krunal Oza
article-published-date: "9/16/2022 9:25:26 AM"
version-number: 3
article-number: KA-15023
dynamics-url: "https://adobe-ent.crm.dynamics.com/main.aspx?forceUCI=1&pagetype=entityrecord&etn=knowledgearticle&id=ee0b6fe9-9e35-ed11-9db1-002248086a9c"
source-git-commit: e8f4ca2dd578944d4fe399074fab461de88ad247
workflow-type: tm+mt
source-wordcount: '1055'
ht-degree: 0%

---

# 在Adobe啟動中實作Video Analytics

## 說明

<br>環境<br><br>


本文提供使用Media Heartbeat SDK在AdobeLaunch中實作YouTube視訊追蹤的步驟。


<br><br>問題/症狀<br><br>
<b>先決條件</b>


| <ol>   <li>您有作用中的Adobe啟動實作。</li>   <li>報表套裝已啟用媒體收集功能。</li>   <li>報表套裝已對應至Adobe Experience Cloud中正確的Analytics登入公司。</li>   <li>您在Experience Launch中擁有發佈Adobe。</li>   <li>您已熟悉AdobeLaunch UI及其運作方式。</li>  </ol><br> |
| --- |



## 解析度


<b>步驟1:建立新規則</b>

按一下「規則」標籤下的「新增規則」按鈕，在您的AdobeLaunch屬性中建立新規則。 此規則將包含載入YouTube視訊、Video Analytics和YouTube iFrame API指令碼的事件條件。

- 在「名稱」(Name)文本框中指定規則名稱。




<b>步驟2:新增事件和/或條件</b>

按一下「事件與條件」下的+按鈕，建立條件以啟動YouTube影片。 在我的範例中，我新增了「元素存在」條件，以尋找特定的div「播放器」來啟動YouTube影片。



<b>步驟3:新增動作 — 設定變數</b>

按一下動作下方的+按鈕以建立新動作項目。 這會作為設定Video Analytics變數的單一設定點。 我用了一些硬式編碼的值。 不過，您可以使用資料元素來填入這些變數。

1. 從「擴充功能」下拉式清單中選取「核心」。
2. 從「動作類型」下拉式清單中選取「自訂程式碼」。
3. 在「名稱」(Name)文本框中添加操作名稱。
4. 在「語言」下選擇「Javascript」。
5. 勾選「全域執行」。
6. 按一下「開啟編輯器」。
7. 新增程式碼，然後按一下「儲存」。 請務必根據您的公司和報表套裝更新值。



```
(function() {    'use strict';
    // Export symbols.
    window.Configuration = {
        PLAYER: {
            NAME: 'sample player name'
            //VIDEO_ID: 'sample video id',
           //VIDEO_NAME: sample video name'
        },
        VISITOR: {
            MARKETING_CLOUD_ORG_ID: 'experience cloud ID',
            TRACKING_SERVER: 'tracking server',
            DPID: '',
            DPUUID: ''
        },
        APP_MEASUREMENT: {
            RSID: 'report suite id',
            TRACKING_SERVER: 'tracking server',
            PAGE_NAME: 'page name',
            CHAR_SET: 'UTF-8'
        },
        HEARTBEAT: {
            TRACKING_SERVER: 'heartbeat tracking server',
            PUBLISHER: 'publisher id',
            CHANNEL: 'channel',
            OVP: 'ovp name',
            SDK: 'sgk version',
       SSL: 'false',
       DEBUG: 'true'
        }
    };
})();
```


(function(){ &#39;use strict&#39;;    //導出符號。
    window.Configuration = { PLAYER:{名稱：「範例播放器名稱」//VIDEO_ID:&#39;sample video id&#39;, //VIDEO_NAME:範例視訊名稱&#39; }, VISITOR:{ MARKETING_CLOUD_ORG_ID:&#39;experience cloud ID&#39;, TRACKING_SERVER:&#39;tracking server&#39;,DPID:&quot;,DPUUID:&quot; }, APP_MEASUREMENT:{ RSID:&#39;report suite id&#39;, TRACKING_SERVER:&#39;tracking server&#39;, PAGE_NAME:&#39;page name&#39;, CHAR_SET:&#39;UTF-8&#39; }，心率：{ TRACKING_SERVER:&#39;heartbeat追蹤伺服器&#39;,PUBLISHER:&#39;publisher id&#39;，頻道：&#39;channel&#39;, OVP:&#39;ovp name&#39;, SDK:&#39;sgk version&#39;,SSL:&#39;false&#39;, DEBUG:&#39;true&#39; } };})(;



<b>步驟4:新增動作訪客ID服務</b>

Media Analytics需要訪客ID服務的例項。 您需要從Adobe Analytics UI的「代碼管理器」下載訪客ID服務程式碼。

下載訪客ID服務程式碼後，按一下動作下方的+按鈕以建立新動作項目，然後

1. 從「擴充功能」下拉式清單中選取「核心」。
2. 從「動作類型」下拉式清單中選取「自訂程式碼」。
3. 在「名稱」(Name)文本框中添加操作名稱。
4. 在「語言」下選擇「Javascript」。
5. 勾選「全域執行」。
6. 按一下「開啟編輯器」。
7. 在底部，新增下列程式碼並按一下「儲存」 。
8. 在底部，新增下列程式碼並按一下「儲存」 。


var visitor = Visitor.getInstance(&quot;Experience CloudID&quot;, { trackingServer:&quot;tracking server&quot;, //與s.trackingServer trackingServerSecure相同：&quot;追蹤伺服器&quot; //與s.trackingServerSecure }相同);

<b>步驟5:新增動作 — Appmeasurement程式碼</b>

Media Analytics需要Appmeasurement的例項。 您需要從Adobe Analytics UI中的代碼管理器下載。

下載Appmeasurement程式碼後，按一下動作下方的+按鈕以建立新動作項目，然後

1. 從「擴充功能」下拉式清單中選取「核心」。
2. 從「動作類型」下拉式清單中選取「自訂程式碼」。
3. 在「名稱」(Name)文本框中添加操作名稱。
4. 在「語言」下選擇「Javascript」。
5. 勾選「全域執行」。
6. 按一下「開啟編輯器」。
7. 新增訪客ID服務程式碼。
8. 在頂端新增下列程式碼，然後按一下「儲存」 。

<br><br><br>//初始化AppMeasurement
<br>var s_account=&quot;report suite id&quot;
<br>var s=s_gi(s_account)
<br>/\*\*\*\*\*\*\*\*訪客ID服務設定 — 需要VisitorAPI.js \*\*\*\*\*\*\*\*\*\*/
<br>s.visitor=Visitor.getInstance(&quot;Experience CloudID&quot;)<br><br><br>
<b>步驟6:新增動作 — 心率程式碼</b>

從下載心率SDK [https://github.com/Adobe-Marketing-Cloud/media-sdks/tree/master/sdks/js/libs](https://github.com/Adobe-Marketing-Cloud/media-sdks/tree/master/sdks/js/libs).

下載心率程式碼後，按一下動作下方的+按鈕以建立新動作項目，然後

1. 從「擴充功能」下拉式清單中選取「核心」。
2. 從「動作類型」下拉式清單中選取「自訂程式碼」。
3. 在「名稱」(Name)文本框中添加操作名稱。
4. 在「語言」下選擇「Javascript」。
5. 勾選「全域執行」。
6. 按一下「開啟編輯器」。
7. 新增訪客ID服務程式碼。
8. 在底部，新增下列程式碼並按一下「儲存」 。


//建立MediaHeartbeat類別的本機參考

var MediaHeartbeat = ADB.va.MediaHeartbeat;var MediaHeartbeatConfig = ADB.va.MediaHeartbeatConfig;var MediaHeartbeatDelegate = ADB.va.MediaHeartbeatDelegate;

//媒體心率初始化

var mediaConfig = new MediaHeartbeatConfig();mediaConfig.trackingServer = Configuration.HEARTBEAT.TRACKING_SERVER;mediaConfig.playerName = Configuration.PLAYER.NAME;mediaConfig.channel = Configuration.HEARTBEAT.CHANNEL;mediaConfig.debugLogging = Configuration.HEARTBEAT.DEBUG;

mediaConfig.appVersion = Configuration.HEARTBEAT.SDK;mediaConfig.ssl = Configuration.HEARTBEAT.SDK;mediaConfig.ovp = Configuration.HEARTBEAT.OVP;

//實作MediaHeartbeatDelegate通訊協定。
var mediaDelegate = new MediaHeartbeatDelegate();

// 初始化

var appMeasurement = new AppMeasurement();appMeasurement.visitor = visitor;appMeasurement.trackingServer = Configuration.APP_MEASUREMENT.TRACKING_SERVER;appMeasurement.account = Configuration.APP_MEASUREMENT.RSID;appMeasurement.pageName = Configuration.APP_MEASUREMENT.PAGE_NAME;appMeasurement.charSet = Configuration.APP_MEASUREMENT.CHAR_SET;var contextData = { pageURL:document.URL, isUserLoggedIn:&quot;false&quot;, tvStation:《電視台範例》，程式設計師：&quot;Khurshid Alam&quot; };var mediaInfo;var videostarted = false;var metaDataLoaded = false;



<b>步驟7:新增動作 — YouTube IFrame API程式碼</b>

1. 從「擴充功能」下拉式清單中選取「核心」。
2. 從「動作類型」下拉式清單中選取「自訂程式碼」。
3. 在「名稱」(Name)文本框中添加操作名稱。
4. 在「語言」下選擇「Javascript」。
5. 勾選「全域執行」。
6. 按一下「開啟編輯器」。
7. 新增下列程式碼，然後按一下「儲存」。


// 2. 此程式碼會非同步載入IFrame播放器API程式碼。

var tag = document.createElement(&#39;script&#39;);tag.src = &quot;https://www.youtube.com/iframe_api&quot;;var firstScriptTag = document.getElementsByTagName(&#39;script&#39;)0;firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

// 3. 此函式會在API程式碼下載後建立iframe(和YouTube播放器)//。

var播放器；函式onYouTubeIframeAPIReady(){ console.log（&quot;onYouTubeIframeAPIReady呼叫……&quot;）;       player = new YT.Player(&#39;player&#39;, { height:』390」，寬度：&#39;640&#39;, videoId:&#39;xWYHvIjvMnY&#39;，事件：{ &#39;onReady&#39;:onPlayerReady, &#39;onStateChange&#39;:onPlayerStateChange, &#39;onPlaybackQualityChange&#39;:onPlaybackQualityChange, &#39;onPlaybackRateChange&#39;:onPlaybackRateChange, &#39;onError&#39;:onPlayerError });}

// 4. 視訊播放器準備就緒時，API將呼叫此函式。

函式onPlayerReady(event){ metaDataLoaded = true;       player.playVideo();}

// 5. 播放器狀態變更時，API會呼叫此函式。
//函式指出播放視訊時(state=1), //播放器應播放6秒，然後停止。

函式onPlayerStateChange(event){ switch(event.data){案例YT.PlayerState.PLAYING:  console.log(&quot;\*\*\*HB Playing&quot;);                     if(metaDataLoaded){ if(Math.floor(event.target.getCurrentTime())== 0){ console.log(&quot;\*\*\*HB Start&quot;);                                   MediaHeartbeat = ADB.va.MediaHeartbeat;                                   mediaInfo = MediaHeartbeat.createMediaObject(event.target.getVideoData()。title, event.target.getVideoData()。video_id, Math.floor(event.target.getDuration()), MediaHeartbeat.StreamType.VOD);                                     MediaHeartbeat = new MediaHeartbeat(mediaDelegate, mediaConfig, appMeasurement);                                   mediaDelegate.getCurrentPlaybackTime = function(){傳回Math.floor(event.target.getCurrentTime());                           };                                   MediaHeartbeat.trackSessionStart(mediaInfo, contextData);                                   MediaHeartbeat.trackPlay();                                   videostarted = true;                     }其他{ console.log（&quot;\*\*\*\*HB播放&quot;）;                           MediaHeartbeat.trackPlay();                     }個中斷；              case YT.PlayerState.PAUSED:                     console.log（&quot;\*\*\*HB暫停&quot;）;                     MediaHeartbeat.trackPause();                     休息；              case YT.PlayerState.ENDED:                     console.log（&quot;\*\*\*HB已結束&quot;）;                     MediaHeartbeat.trackComplete();                     MediaHeartbeat.trackSessionEnd();                     休息；              案例–1:                     console.log（&quot;\*\*\*HB已卸載&quot;）;                     MediaHeartbeat.trackComplete();                     MediaHeartbeat.trackSessionEnd();                     休息；       }

}

函式onPlayerPlaybackQualityChange(event){ console.log(&quot;onPlayerPlaybackQualityChange:event.data:&quot;+ event.data);}

函式onPlayerPlaybackRateChange(event){ console.log(&quot;onPlayerPlaybackRateChange:event.data:&quot;+ event.data);}

函式onPlayerError(event){ console.log(&quot;onPlayerError:event.data:&quot;+ event.data);}



<b>步驟8:新增HTML</b>

在您的HTML程式碼中新增下列程式碼。

!-- 1. iframe（和視訊播放器）將取代此div標籤。 — div id=&quot;player&quot;/divbr

<b>步驟8:發佈</b>

發佈屬性並測試。


