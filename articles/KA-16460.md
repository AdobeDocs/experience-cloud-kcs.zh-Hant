---
title: 「如何重新索引同步 AEM 索引 | AEM、Oak」
description: 說明
solution: Experience Manager
product: Experience Manager
applies-to: "Experience Manager"
keywords: 「KCS」
resolution: Resolution
internal-notes: "Helpx Link: helpx.adobe.com/experience-manager/kb/how-to-reindex-a-synchronous-AEM-index-AEM-Oak.html"
bug: false
article-created-by: Emily Geary
article-created-date: "3/17/2021 9:19:48 PM"
article-published-by: Emily Geary
article-published-date: "3/17/2021 9:21:41 PM"
version-number: 2
article-number: KA-16460
dynamics-url: "https://adobe-ent.crm.dynamics.com/main.aspx?forceUCI=1&pagetype=entityrecord&etn=knowledgearticle&id=3613fb7d-6687-eb11-a812-000d3a593216"
exl-id: 1209609f-84a9-4810-b7c8-1193b09f82d7
source-git-commit: 0c3e421beca46d9fe1952b1f98538a50697216a0
workflow-type: tm+mt
source-wordcount: '412'
ht-degree: 100%

---

# 如何重新索引同步 AEM 索引 | AEM、Oak

## 說明


如何正確地重新索引同步 Oak 索引而不會導致停機？


## 解析度


只要將重新索引屬性設定為 true 來重新索引同步索引即會導致同步操作，這可能就會導致 Oak 執行個體擱置。若要避免這種情況，請將索引傳送到背景對話串。 請依照下列步驟執行此操作：

<b>步驟 1：</b>在背景對話串中重新索引

1. 在要啟用非同步索引的屬性索引的索引定義上從 CRXDE Lite 設定以下屬性 - `/oak:index/property` 索引

   `reindex=true`

   `reindex-async=true`
2. 若要驗證上述操作是否重新整理了節點，應設定 `async="async-reindex"`。
3. 叫用 `startPropertyIndexAsyncReindex` (在 `PropertyIndexAsyncReindex` MBean 上)。這將啟動搜尋此類索引的背景作業。叫用後，您應該會看到一條紀錄行將執行重新索引...
4. 重新索引完成後，重新索引標幟將被重設為 false。
5. 重新叫用步驟 3 以將索引變更回同步索引。如果未刪除非同步標幟，則可能必須多次叫用 Mbean (如果同時發生影響此索引的變更，則可能會發生這種情況)。



*注意：*&#x200B;只有 `async="async-reindex"` 將被移除，因為它控制索引將發生在哪個對話串上。 此 `reindex-async` 屬性只是一個不會自動變更的設定標幟。這表示您要為控制所有未來重新索引的特定索引定義將其設定一次。然後可預期它會留在那裡，於是您就不需要再次觸摸它了。


<b>步驟 2：</b>移除重新索引查核點 (僅限 AEM 6.2 和更早版本)

在不同步重新索引的流程中，會建立一個存放庫查核點。索引任務完成後，必須按如下所述將其釋出，以確保稍後可順利進行修訂垃圾收藏集：

1. 首先，開啟 CheckpointManager MBean：

   MongoMK - [/system/console/jmx/org.apache.jackrabbit.oak%3Aname%3DDocument+node+store+checkpoint+management%2Ctype%3DCheckpointManger](http://localhost:4502/system/console/jmx/org.apache.jackrabbit.oak%3Aname%3DDocument+node+store+checkpoint+management%2Ctype%3DCheckpointManger)

   TarMK - [/system/console/jmx/org.apache.jackrabbit.oak%3Aname%3DSegment+node+store+checkpoint+management%2Ctype%3DCheckpointManger](http://localhost:4502/system/console/jmx/org.apache.jackrabbit.oak%3Aname%3DSegment+node+store+checkpoint+management%2Ctype%3DCheckpointManger)
2. 叫用 `listCheckpoints()` 作業
3. 找到包含 `name=async-reindex` 屬性的查核點列。
4. 將其 id 值複製到剪貼簿

   在 MongoMK 上，它將看起來類似這樣：`r1234567aaaa-0-1`

   在 TarMK 上，它將看起來類似這樣：`6eac07d0-fe27-4d16-82f8-6d5da4cefd67`
5. 然後開啟 `releaseCheckpoint()` 作業。
6. 將複製的 id 貼上為 p1，然後按一下「叫用」。
7. 此步驟將釋出查核點。
