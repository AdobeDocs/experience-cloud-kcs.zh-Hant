---
title: '"如何重新索引同步AEM索引 | AEM, Oak」'
description: 說明
solution: Experience Manager
product: Experience Manager
applies-to: "Experience Manager"
keywords: "KCS"
resolution: Resolution
internal-notes: "Helpx Link: helpx.adobe.com/experience-manager/kb/how-to-reindex-a-synchronous-AEM-index-AEM-Oak.html"
bug: false
article-created-by: Emily Geary
article-created-date: "3/17/2021 9:19:48 PM"
article-published-by: Emily Geary
article-published-date: "3/17/2021 9:21:41 PM"
version-number: 2
article-number: KA-16460
dynamics-url: "https://adobe-ent.crm.dynamics.com/main.aspx?forceUCI=1&pagetype=entityrecord&etn=knowledgearticle&id=3613fb7d-6687-eb11-a812-000d3a593216"
exl-id: 1209609f-84a9-4810-b7c8-1193b09f82d7
source-git-commit: 0c3e421beca46d9fe1952b1f98538a50697216a0
workflow-type: tm+mt
source-wordcount: '412'
ht-degree: 0%

---

# 如何重新索引同步AEM索引 | AEM、Oak

## 說明


如何正確重新索引同步Oak索引而不造成停機？


## 解析度


只需將reindex屬性設為true，即可重新索引同步索引，導致同步操作導致Oak例項擱置。 為避免此情況，請將索引發送到後台線程。  若要這麼做，請遵循下列步驟：

<b>步驟1:</b> 在後台線程中重新索引

1. 從CRXDE Lite中設定以下屬性，以便為要非同步索引的屬性索引啟用索引定義 —  `/oak:index/property` 索引

   `reindex=true`

   `reindex-async=true`
2. 若要驗證上述是否重新整理節點， `async="async-reindex"` 應設定。
3. 叫用 `startPropertyIndexAsyncReindex` 在 `PropertyIndexAsyncReindex` MBean。 這將啟動後台作業，以搜索此類索引。 在調用後，您應該會看到日誌行Reindexing將被執行……
4. 完成重新索引後，重新索引標幟將重設為false。
5. 重新調用步驟3以將索引更改回同步索引。 如果未刪除非同步標幟，則可能必須叫用Mbean多次（如果同時影響此索引的變更發生，就可能發生此情況）。



*注意：* 僅 `async="async-reindex"` 將被刪除，因為將在哪個線程執行索引。  此 `reindex-async` 屬性只是不會自動變更的設定標幟。 其思想是，您只需為控制所有未來重新索引的特定索引定義設定一次索引。 然後人們就認為它會留在那裡，然後你就不需要再碰它了。


<b>步驟2:</b> 移除重新索引查核點(僅限AEM 6.2及舊版)

在非同步重新索引過程中，會建立存放庫查核點。 索引任務完成後，必須按以下說明發行，以確保以後的修訂垃圾收集工作順利進行：

1. 首先，開啟CheckpointManager MBean :

   MongoMK - [/system/console/jmx/org.apache.jackrabbit.oak%3Aname%3Document+node+store+checkpoint+management%2Ctype%3DCheckpointManger](http://localhost:4502/system/console/jmx/org.apache.jackrabbit.oak%3Aname%3DDocument+node+store+checkpoint+management%2Ctype%3DCheckpointManger)

   TarMK - [/system/console/jmx/org.apache.jackrabbit.oak%3Aname%3DSegment+node+store+checkpoint+management%2Ctype%3DCheckpointManger](http://localhost:4502/system/console/jmx/org.apache.jackrabbit.oak%3Aname%3DSegment+node+store+checkpoint+management%2Ctype%3DCheckpointManger)
2. 叫用 `listCheckpoints()` 操作
3. 查找具有 `name=async-reindex` 屬性。
4. 將其ID值複製到剪貼簿

   在MongoMK上，看起來會類似這樣： `r1234567aaaa-0-1`

   在TarMK上，看起來會類似這樣： `6eac07d0-fe27-4d16-82f8-6d5da4cefd67`
5. 然後開啟 `releaseCheckpoint()` 操作。
6. 將複製的id貼上為p1，然後按一下「叫用」。
7. 此步驟將釋出查核點。
