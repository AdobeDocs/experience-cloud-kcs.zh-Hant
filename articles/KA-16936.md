---
title: 「透過 SSL/TLS 已終止的負載平衡器 | AEM 存取時，AEM 會將使用者重新導向 http」
description: 說明
solution: Experience Manager
product: Experience Manager
applies-to: "Experience Manager"
keywords: 「KCS」
resolution: Resolution
internal-notes: "Helpx Link: https://helpx.adobe.com/experience-manager/kb/AEM-redirecting-back-to-http-on-accessed-via-SSL-terminated-Load-Balancer.html"
bug: false
article-created-by: Emily Geary
article-created-date: "4/12/2021 6:21:34 PM"
article-published-by: Emily Geary
article-published-date: "4/12/2021 6:26:15 PM"
version-number: 1
article-number: KA-16936
dynamics-url: "https://adobe-ent.crm.dynamics.com/main.aspx?forceUCI=1&pagetype=entityrecord&etn=knowledgearticle&id=684ec8e8-bb9b-eb11-b1ac-000d3a3680d8"
exl-id: 52e50c09-67f2-46a2-90a7-df769d76a0dd
source-git-commit: 0c3e421beca46d9fe1952b1f98538a50697216a0
workflow-type: tm+mt
source-wordcount: '341'
ht-degree: 100%

---

# 透過 SSL/TLS 已終止的負載平衡器 | AEM 存取時，AEM 會將使用者重新導向 http

## 說明


透過 SSL 已終止的負載平衡器 (或 SSL 已終止的 CDN) 存取 AEM 時，則 AEM 會從 https 重新導向 http。

負載平衡器處的 SSL 終止表示 SSL 憑證已安裝在負載平衡器中。一般使用者透過 `https://` 存取網站，而 Dispatcher/網頁伺服器和 AEM 則在後端透過 `http://` 存取。



<b>原因</b>

不同的負載平衡器會傳送不同的標題來通知後端系統 SSL 已在上游終止。例如，[ Amazon ELB 使用標題「X-Forwarded-Proto：https」](https://docs.aws.amazon.com/elasticloadbalancing/latest/classic/x-forwarded-headers.html#x-forwarded-proto)。


## 解析度


若要解決此問題：

<b>I. 更新 Dispatcher `/clientheaders` 設定</b>

請參閱負載平衡器的文件，了解它設定了哪個標題來通知下游系統它終止了 SSL。為簡化起見，在這些步驟中，我們假設正確的 HTTP 標題為 *`X-Forwarded-Proto: https`*

1. 登入到 Dispatcher 伺服器。
2. 開啟 Dispatcher 陣列`.any`設定。
3. 新增標題至 `/clientheaders` 區段。


如果您使用沒有負載平衡器的 Dispatcher，或者您的負載平衡器或 Proxy 無法設定 `X-Forwarded-Proto` 標頭，則您可以在網頁伺服器或 Dispatcher 層級進行設定。如果您正在使用 [!DNL Apache HTTP Server]，則請使用以下指令更新您的 HTTPS VirtualHost：


| 1 | `RequestHeader ` `set` `X-Forwarded-Proto ` `"https"` |
| --- | --- |


<b>II. 更新標題設定：</b>

1. 前往 *http://host:port*/system/console/configMgr/org.apache.felix.http.sslfilter.SslFilter，並以管理員身分登入。
2. 將 SSL 轉寄標題設定為 `X-Forwarded-Proto`。
3. 將 SSL 轉寄值設定為 https。
4. 按一下儲存。


注意：

沒有用於告知後端使用哪種通訊協定的反向 Proxy 標題的標準。但是，這裡有一些是已知的：

- Amazon ELB ([!DNL Elastic Load Balancer]) 使用 `X-Forwarded-Proto: https` 標題。
- [!DNL Amazon Cloudfront]CDN 使用 `X-Cloudfront-Proto: https` 標題。


<b>III. 更新 Jetty OSGi 設定 (AEM 6.3 及更高版本)</b>

在 AEM 6.3 及更高版本上，需要額外的設定：

- 登入到 http://aem-host:port/system/console/configMgr/org.apache.felix.http。
- 啟用設定 <b>啟用 Proxy/負載平衡器連線</b>，並將其儲存。
