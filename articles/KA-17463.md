---
title: Dispatcher虛名URL
description: 說明
solution: Experience Manager
product: Experience Manager
applies-to: Experience Manager
keywords: KCS
resolution: Resolution
internal-notes: null
bug: false
article-created-by: Krunal Oza
article-created-date: 2/2/2023 10:54:02 AM
article-published-by: Krunal Oza
article-published-date: 2/24/2023 11:47:31 AM
version-number: 3
article-number: KA-17463
dynamics-url: https://adobe-ent.crm.dynamics.com/main.aspx?forceUCI=1&pagetype=entityrecord&etn=knowledgearticle&id=9a85c1e3-e7a2-ed11-aad1-6045bd006149
exl-id: 8576ab35-d33b-43c4-94a8-d63fceb21a86
source-git-commit: 41fe73a29e4e479f1ef3668171a9726bd4e8c1b7
workflow-type: tm+mt
source-wordcount: '966'
ht-degree: 1%

---

# Dispatcher虛名URL

## 說明 {#description}

<b>環境</b>
Experience Manager


<b>問題/症狀</b>
本檔案將協助您瞭解AEM如何處理虛名URL，以及其他一些使用重寫規則來對應更靠近傳送邊緣之內容的技術

什麼是虛名URL

當您的內容位於合理的資料夾結構中時，它並不總是位於易於參照的URL中。  虛名URL就像捷徑。  參照實際內容所在位置的較短或唯一URL。

範例： <b>/aboutus</b> 指向 <b>/content/we-retail/us/en/about-us.html</b>

AEM作者可選擇在AEM中為內容設定虛名url屬性並將其發佈。

若要使用此功能，您必須調整Dispatcher篩選器，以允許虛名通過。  以作者設定這些虛名頁面專案所需的速率調整Dispatcher設定檔案，會使這種調整變得不合理。

因此，Dispatcher模組具有自動允許內容樹中列出的任何虛值的功能。


## 解決方法 {#resolution}


運作方式


製作虛名URL

作者在AEM中造訪頁面，然後造訪頁面屬性，並在虛名URL區段中新增專案。
在儲存變更並啟動頁面後，現在會將虛名指派給此頁面。
觸控式UI：
![](assets/c1e59dbd-38b4-ed11-83fe-6045bd006149.png)![](assets/c3e59dbd-38b4-ed11-83fe-6045bd006149.png)


傳統內容尋找器：
![](assets/c2e59dbd-38b4-ed11-83fe-6045bd006149.png)![](assets/c4e59dbd-38b4-ed11-83fe-6045bd006149.png)
注意：請瞭解這很容易發生名稱空間問題。
虛專案是所有頁面的全域專案，這只是您必須計畫的解決方法之一。 我們稍後會說明其中幾項。
資源解析/對應

每個虛名專案都是用於內部重新導向的sling對應專案。
造訪AEM例項Felix主控台即可看到這些對應(<b>/system/console/jcrresolver</b>)以下是虛條目建立的對應條目的熒幕擷圖：
![](assets/c5e59dbd-38b4-ed11-83fe-6045bd006149.png)



在上述範例中，當我們要求AEM執行個體造訪/aboutus時，它將解析為/content/we-retail/us/en/about-us.html

Dispatcher自動允許篩選器

處於安全狀態的Dispatcher會篩選掉路徑/上透過Dispatcher的請求，因為這是JCR樹的根目錄。
請務必確保發佈者僅允許來自/content和其他安全路徑的內容，而不允許/system等路徑的內容。以下是/的基本資料夾中的問題和虛名URL，那麼我們如何在保持安全的同時允許他們聯絡發佈者？
簡單Dispatcher具有自動篩選允許機制，您必須安裝AEM套件，然後將Dispatcher設定為指向該套件頁面。
[https://experience.adobe.com/#/downloads/content/software-distribution/en/aem.html?package=/content/software-distribution/en/details.html/content/dam/aem/public/adobe/packages/granite/vanityurls-components](https://experience.adobe.com/#/downloads/content/software-distribution/en/aem.html?package=/content/software-distribution/en/details.html/content/dam/aem/public/adobe/packages/granite/vanityurls-components)
Dispatcher的伺服器陣列檔案中有設定區段：


<b>/vanity_urls {</b><b> </b><b>    </b><b> </b><b>/url &quot;/libs/granite/dispatcher/content/vanityUrls.html&quot;</b><b> </b><b>    </b><b> </b><b>/file &quot;/tmp/vanity_urls&quot;</b><b> </b><b>    </b><b> </b><b>/delay 300</b><b> </b><b>}</b>

 
此設定會告訴Dispatcher每300秒從它的AEM執行個體擷取此URL，以擷取我們希望允許通過的專案清單。
它會將其回應的快取儲存在/file引數中，因此在此範例中/tmp/vanity_urls因此如果您以URI造訪AEM執行個體，就會看到它擷取的內容：
![](assets/c6e59dbd-38b4-ed11-83fe-6045bd006149.png)



這是超簡單的清單。

將規則重寫為虛規則

為什麼要提到使用重寫規則，而不使用如上所述內建在AEM中的預設機制？
簡單來說，名稱空間問題、效能，以及可以更好處理的更高層級邏輯。
讓我們再來看看虛專案範例 */aboutus* 至其內容 */content/we-retail/us/en/about-us.html* 使用Apache的mod_rewrite模組完成此作業。

<b>RewriteRule /aboutus /content/we-retail/us/en/about-us.html PT，L，NC</b>


此規則將尋找虛名/aboutus，並從具有PT旗標(Pass Through)的轉譯器中擷取完整路徑。
它也會停止處理所有其他規則L標幟（最後），這表示它不必周遊大型規則清單，例如JCR解析必須執行的規則。
同時不必代理要求並等待AEM發佈者回應此方法的這兩個元素，因此其效能大幅提升。
此處錦上添花的是NC標幟（不區分大小寫），代表如果客戶使用/AboutUs而非/aboutus取代URI，它仍然有效，並允許擷取正確的頁面。
若要建立重寫規則以執行此操作，您可在Dispatcher上建立設定檔(範例： /etc/httpd/conf.d/rewrites/examplevanity_rewrite.rules)，並將其納入.vhost檔案中，以處理需要套用這些虛名url的網域。
以下是包含的範常式式碼片段

/etc/httpd/conf.d/enabled_vhosts/we-retail.vhost VirtualHost \*：80 ServerName weretail.com ServerAlias www.weretail.com ........ 剪取........     IfModule mod_rewrite.c RewriteEngine on LogLevel warn rewrite：info Include /etc/httpd/conf.d/rewrites/examplevanity_rewrite.rules / IfModule ........ 剪取......../VirtualHost



哪一種方法及何處


使用AEM控制虛名專案具有以下優點

- 作者可以即時建立這些檔案
- 它們會與內容共存，並可與內容一起封裝


使用mod_rewrite控制虛名專案具有以下優點

- 解析內容的速度更快
- 更接近一般使用者內容請求的邊緣
- 更多擴充性和選項，可控制如何將內容對應到其他條件
- 可不區分大小寫


請同時使用這兩種方法，以下是建議與准則，以瞭解何時應使用哪一種方法：

- 如果虛值是暫時的，並且規劃了低層流量，則使用AEM內建功能
- 如果虛值是不經常變更且頻繁使用的固定端點，則使用mod_rewrite規則。
- 如果虛名名稱空間（例如：/aboutus）必須對同一AEM執行個體上的多個品牌重複使用，則使用重寫規則。


注意：如果您想使用AEM虛功能並避免名稱空間，您可以制定命名慣例。  使用巢狀如/brand1/aboutus、brand2/aboutus、brand3/aboutus的虛名URL
