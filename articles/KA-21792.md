---
title: '"GraphQL處理空值的變更 | AEM'
description: 說明
solution: Experience Manager as a Cloud Service
product: Experience Manager as a Cloud Service
applies-to: "Experience Manager as a Cloud Service"
keywords: "KCS,Adobe Experience Manager,GraphQL"
resolution: Resolution
internal-notes: null
bug: false
article-created-by: Victoria Barnato
article-created-date: "4/27/2023 7:07:50 PM"
article-published-by: Victoria Barnato
article-published-date: "4/27/2023 7:10:18 PM"
version-number: 6
article-number: KA-21792
dynamics-url: "https://adobe-ent.crm.dynamics.com/main.aspx?forceUCI=1&pagetype=entityrecord&etn=knowledgearticle&id=a1795fca-2ee5-ed11-a7c7-6045bd0061cb"
source-git-commit: 49456a4e39cbbdc507448cf6e6ceb9a2eb1853be
workflow-type: tm+mt
source-wordcount: '0'
ht-degree: 0%

---

# GraphQL中空值處理方式的變更 | AEM

## 說明 {#description}

<b>環境</b><br><br>Experience Manageras a Cloud Service<br><br><br><br><b>問題/症狀</b><br><br>在2023.02.11382版中，已對 <b>GraphQL</b> （開放原始碼查詢語言）實作，可能會在應用程式程式碼中造成非預期的行為，以防其依賴較舊版本的錯誤行為。 
<br>以下提及的解決方案有助於達成以下目標： Adobe Experience Manager(AEM)GraphQL現在透過 *null* 值在所有篩選操作中的一致性。 <br>

## 解決方法 {#resolution}

<b>`CONTAINS_NOT` 和 *null* 值</b><br> <br>第一項變更會運用 `CONTAINS_NOT` 運算元。 在舊版中，這 `CONTAINS_NOT` 未傳回內容片段包含 *null* 值。 這與類似的運算子不一致，例如 `EQUALS_NOT` 或 `NOT_AT`.<br>請確保您的客戶端應用程式能夠處理 *null* AEM在使用 `CONTAINS_NOT`.<br> <br><b>範例:</b>

| <b>篩選片段</b> | <b>資料</b> | <b>2023.02.11382之前的結果</b> | <b>結果從2023.02.11382開始</b> |
| --- | --- | --- | --- |
| myField:{<br>    值：&quot;frag&quot;, <br>    _op:CONTAINS_NOT<br>} | <br>    {<br>        myField:null<br>    }, <br>    {<br>        myField:&quot;一些文字&quot;<br>    },<br>    {<br>        myField:&quot;文本片段&quot;<br>    }<br> | <br>    {<br>        myField:&quot;一些文字&quot;<br>    }<br> | <br>    {<br>        myField:null<br>    },<br>    {<br>        myField:&quot;一些文字&quot;<br>    }<br> |

<b>套用模式 `ALL_OR_EMPTY/ALL` 和 *null* 值</b>
在2023.02.11382中修正的另一個問題與 *null* 值。 應用模式 `ALL_OR_EMPTY` （在陣列/多值欄位上）未傳回片段，而 *null* 相關欄位的值，因此它實際上可如您預期般運作 `ALL` 應用方法。 同時，使用套用模式來篩選多值欄位 `ALL` 會包含該欄位具有空白內容的片段，但不應如此。建議您測試使用其中一種應用模式的查詢，如果查詢不再返回2023.02.11382中的預期結果集，則對其進行更改。

請注意，問題僅存在於某些運算子(2023.02.11382之前)。
例如： `EQUALS_NOT` 按應用方法的預期工作 `ALL_OR_EMPTY`，而 `CONTAINS` 沒有。
<b>範例：</b>

| <b>篩選片段</b> | <b>資料</b> | <b>2023.02.11382之前的結果</b> | <b>結果從2023.02.11382開始</b> |
| --- | --- | --- | --- |
| myArray:{<br>  _expressions:{<br>    值：&quot;1.3&quot;<br>    _operator:EQUALS_NOT<br>    _apply:全部<br>  }<br>} | <br>  {<br>    myArray:null<br>  },<br>  {<br>    myArray:&quot;1.1&quot;、&quot;1.2&quot;、&quot;1.3&quot; <br>  },<br>  {<br>    myArray:&quot;2.1&quot;、&quot;2.2&quot;、&quot;2.3&quot; <br>  }<br> | <br>  {<br>    myArray:null<br>  },<br>  {<br>    myArray:&quot;2.1&quot;、&quot;2.2&quot;、&quot;2.3&quot; <br>  }<br> | <br>  {<br>    myArray:&quot;2.1&quot;、&quot;2.2&quot;、&quot;2.3&quot; <br>  }<br> |
| myArray:{<br>  _expressions:{<br>    值：&quot;2&quot;<br>    _operator:包含<br>    _apply:ALL_OR_EMPTY<br>  }<br>} | <br>  {<br>    myArray:&quot;2.1&quot;、&quot;2.2&quot;、&quot;2.3&quot; <br>  }<br> | <br>  {<br>    myArray:null<br>  },<br>  {<br>    myArray:&quot;2.1&quot;、&quot;2.2&quot;、&quot;2.3&quot; <br>  }<br> |

<b>套用模式： `INSTANCES`, `_instances: 0` 和 *null* 值</b>
最後一個問題也與 *null* 值。 應用模式 `INSTANCES` with`_instances: 0` 不符合包含的內容片段 *null* 值在2023.02.11382之前的相應欄位中，但將從2023.02.11382開始。建議測試使用此星座的查詢，如果查詢不再返回2023.02.11382中的預期結果集，則對其進行更改。
<b>範例：</b>

| <b>篩選片段</b> | <b>資料</b> | <b>2023.02.11382之前的結果</b> | <b>結果從2023.02.11382開始</b> |
| --- | --- | --- | --- |
| myArray:{<br>  _expressions:{<br>    值：&quot;2&quot;<br>    _operator:包含<br>    _apply:例項<br>    _instances:0<br>  }<br>} | <br>  {<br>    myArray:null<br>  },<br>  {<br>    myArray:&quot;1.1&quot;、&quot;1.2&quot;、&quot;1.3&quot; <br>  },<br>  {<br>    myArray:&quot;2.1&quot;、&quot;2.2&quot;、&quot;2.3&quot; <br>  }<br> | <br>  {<br>    myArray:&quot;1.1&quot;、&quot;1.2&quot;、&quot;1.3&quot; <br>  }<br> | <br>  {<br>    myArray:null<br>  },<br>  {<br>    myArray:&quot;1.1&quot;、&quot;1.2&quot;、&quot;1.3&quot; <br>  }<br> |

<b>可能影響客戶的改善項目 `ft-sites-97` 已啟用</b>
擁有 `ft-sites-97`*(GraphQL分頁與最佳化篩選)* 已啟用功能標幟 *befor*2023.02.11382版在升級到2023.02.11382後，可能會遇到以下一個或多個行為更改。未啟用此功能標誌的客戶不受此部分的影響。
<b>對檢查不相等的條件進行null處理</b>
片段欄位，包含 *null* 檢查是否不相等的篩選器會間歇性不符合值。

如果您的程式碼仰賴這些片段而未傳回，您必須調整程式碼以符合預期的行為。


| <b>篩選片段</b> | <b>資料</b> | <b>中間實施的結果</b> | <b>最終實施的結果</b> |
| --- | --- | --- | --- |
| myField:{<br>  值：「一些文字」，<br>  _op:EQUALS_NOT<br>} | <br>  {<br>    myField:null<br>  },<br>  {<br>    myField:&quot;一些文字&quot;<br>  },<br>  {<br>    myField:&quot;文本片段&quot;<br>  }<br> | <br>  {<br>    myField:&quot;一些文字&quot;<br>  }<br> | <br>  {<br>    myField:null<br>  },<br>  {<br>    myField:&quot;一些文字&quot;<br>  }<br> |

<b>篩選運算子 `NOT_AT` 包含日期/時間值</b>
篩選運算子 `NOT_AT` 時斷時續地無法正確處理資料/時間值。 相反，它的運作方式更像 `AFTER` 條件。 
如果您的程式碼仰賴不正確的行為，您應將篩選條件切換為 `AFTER`.
<b>陣列： `INSTANCES` with `_instances: 0` 無法正常運作</b>
篩選條件 `INSTANCES` （在陣列/多值欄位上）與 `_instances` 設為0時間性無法如預期運作，而未傳回任何實際應有的項目。

受此問題影響的篩選片段看起來會像： `doubleArray: { _expressions: { value: 0, _operator: GREATER, _apply: INSTANCES, _instances: 0 } }`

如果您依賴錯誤行為，則需要重寫查詢以傳回與之前相同的結果。


| <b>篩選片段</b> | <b>資料</b> | <b>中間實施的結果</b> | <b>最終實施的結果</b> |
| --- | --- | --- | --- |
| myArray:{<br>  _expressions:{<br>    值：20<br>    _operator:等於<br>    _apply:例項<br>    _instances:0<br>  }<br>} | <br>  {<br>    myArray:null<br>  },<br>  {<br>    myArray:10, 20, 30 <br>  },<br>  {<br>    myArray:11, 12, 13 <br>  }<br> |  | <br>  {<br>    myArray:null<br>  },<br>  {<br>    myArray:11, 12, 13 <br>  }<br> |

