---
title: 「AEM 對話串傾印分析」
description: 說明
solution: Experience Manager
product: Experience Manager
applies-to: "Experience Manager"
keywords: 「KCS」
resolution: Resolution
internal-notes: "Helpx Link: https://helpx.adobe.com/experience-manager/kb/thread-dump-analysis.html"
bug: false
article-created-by: Emily Geary
article-created-date: "3/17/2021 9:11:03 PM"
article-published-by: Emily Geary
article-published-date: "3/17/2021 9:13:37 PM"
version-number: 2
article-number: KA-16458
dynamics-url: "https://adobe-ent.crm.dynamics.com/main.aspx?forceUCI=1&pagetype=entityrecord&etn=knowledgearticle&id=e70a8345-6587-eb11-a812-000d3a593216"
exl-id: 74bb70e4-a09b-48fc-8378-96a1736e5ebf
source-git-commit: a59847e2e7e37f432cb01150b9444cd9dbf585df
workflow-type: tm+mt
source-wordcount: '1000'
ht-degree: 100%

---

# AEM 對話串傾印分析

## 說明

分析 AEM [!DNL Java]對話串傾印 (使用 [IBM 對話串分析器](http://www.ibm.com/developerworks/community/groups/service/html/communityview?communityUuid=2245aa39-fa5c-4475-b891-14c205f7333c)工具)。

## 解析度

1. 下載並安裝 [IBM 對話串分析器](https://www.ibm.com/developerworks/community/groups/service/html/communityview?communityUuid=2245aa39-fa5c-4475-b891-14c205f7333c) (我們將其簡稱為 IBM TDA)
1. 從體驗效能問題的 AEM 執行個體擷取[對話串傾印](https://helpx.adobe.com/tw/experience-manager/kb/TakeThreadDump.html)。
1. 在 IBM TDA 中開啟對話串傾印。
1. 若要檢視對話串傾印的詳細資訊，請選取清單中的檔案，然後按一下「對話串詳細資訊」按鈕\*。

![tda-threaddetail](https://helpx.adobe.com/content/dam/help/en/experience-manager/kb/thread-dump-analysis/_jcr_content/main-pars/image_1587732783/tda-threaddetail.png "tda-threaddetail")

1. 按「堆疊深度」排序，最長的堆疊在頂端。

   ![tda-image1](https://helpx.adobe.com/content/dam/help/en/experience-manager/kb/thread-dump-analysis/_jcr_content/main-pars/image/tda-image1.png)

1. 檢閱堆疊深度為 10 行或更長的對話串。 這些通常是最受關注的對話串。 記下感興趣的對話串。
1. 按對話串「狀態」排序
1. 向下捲動至「可執行」對話串。可執行的對話串指在進行對話串傾印時積極使用 CPU 時間的對話串。

   *注意：檢閱「可執行的」對話串時，您可以忽略在本頁底部[可忽略的對話串](https://helpx.adobe.com/tw/experience-manager/kb/thread-dump-analysis.html#ignorethreads)區段中列出的對話串。*

1. 查找屬於應用程式一部分的可執行的對話串，例如，背景作業對話串或請求對話串 (請求對話串的名稱如下：*127.0.0.1 1347028187737 GET /content/sites/global/en/sitemap.static-delivery.httpd.html HTTP/1.1*)。找到它們後，請逐一按一下。

1. 對於每個請求對話串，您都可以透過查看對話串名稱中的時間戳記來發現使用者的瀏覽器何時向伺服器發出請求。 例如，在以上對話串名稱中，時間戳記 (以毫秒為單位的 unix epoch 格式) 為 1347028187737。  我們可以利用 [www.epochconverter.com](http://www.epochconverter.com/) 將該 epoch 數字轉換為日期/時間。 每個對話串傾印都會顯示執行時的日期和時間。 您可以透過請求時間和對話串傾印時間之間的時間差來了解請求活動的時間。

1. 檢閱過請求對話串後，捲動瀏覽其他「可執行的」對話串。 找到感興趣的「可執行的」對話串後，請查看中間面板「等待對話串」。 那裡列出的對話串正在等待所選取的對話串釋出監視器。 如果您沒有看到任何等待對話串，那麼您選取的對話串可能仍然是[鎖定](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/concurrent/locks/Lock.html) 的所有者 (參閱[鎖定](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/concurrent/locks/Lock.html)的實作類別，以了解詳細資訊)。例如，透過 [ReentrantReadWriteLock](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/concurrent/locks/ReentrantReadWriteLock.html)，您無法分辨哪個對話串是鎖定持有者，因為鎖定會在內部實作多個監視器。 因此，您可能必須查看原始程式碼以將其和可能是鎖定持有者的對話串對應。

1. 如果對話串有許多其他對話串正在等待的鎖定或監視器，則請檢查其餘的對話串傾印以查看是否可以找到有相同問題的其他對話串。 查看其他對話串中是否仍然存在相同的對話串 (在 IBM TDA 中，您可以選取多個對話串傾印並按一下「比較對話串」按鈕\* 以檢視多個對話串傾印中的對話串狀態。

   ![tda-comparethreads](https://helpx.adobe.com/content/dam/help/en/experience-manager/kb/thread-dump-analysis/_jcr_content/main-pars/image_1159496390/tda-comparethreads.png)

1. 請參閱以下螢幕擷圖中的收集器服務：

   ![tda-Image2](https://helpx.adobe.com/content/dam/help/en/experience-manager/kb/thread-dump-analysis/_jcr_content/main-pars/image_1730877898/tda-Image2.png)

1. 在此檢視中，您可以查看多個對話串傾印中的對話串，以了解它是否為長時間執行的對話串。 基本上，如果對話串在多個傾印中處於可執行狀態並且有長堆疊，則通常表示它是一個長時間執行的對話串。

1. 如果您沒有找到太多，查看可執行的對話串，然後返回對話串清單，選取一個對話串傾印，接著按一下頂端面板上的「監視器詳細資訊」按鈕\*。IBM TDA 將開啟視窗，顯示擁有對話串及其等待對話串的監視器樹檢視。注意：它可能會顯示一些對話串池對話串，如 servlet 引擎對話串池監視器，可忽略閒置的對話串。 您通常可以分辨對話串是否為閒置的對話串池對話串，因為大多數時候它們只有 10 個或更少的堆疊行。

![tda-monitordetail](https://helpx.adobe.com/content/dam/help/en/experience-manager/kb/thread-dump-analysis/_jcr_content/main-pars/image_1106466084/tda-monitordetail.png)

<b>對話串層級 CPU 使用率 (僅限 [!DNL Linux] 平台)：</b>

1. 如果除了對話串傾印之外還擷取了「top -H -b -n1 -p javapid」輸出，那麼您可以交叉參照對話串層級 CPU 使用率。 開啟頂端輸出並獲取正在使用 CPU 的對話串的流程 ID。 將流程 ID 轉換為十六進位，然後在對應的對話串傾印檔案中搜尋該十六進位值。 該 ID 應該和其中一個對話串的「nid」相符。
1. 如果使用最多 CPU 的相符對話串是「VM 對話串」或任何「GC」對話串，那您可能有記憶體問題。 對更多對話串傾印和頂端輸出重複相同的作業，如果出現這些對話串佔用 CPU 時間的模式，則說明存在記憶體問題。
1. 如果您已確認記憶體問題，則在下次發生問題時擷取推積傾印。 請參閱[本文](https://helpx.adobe.com/tw/experience-manager/kb/AnalyzeMemoryProblems.html)以取得有關擷取和分析堆積傾印的更多詳細資訊。

![](https://helpx.adobe.com/libs/cq/ui/resources/0.gif)![](https://helpx.adobe.com/libs/cq/ui/resources/0.gif)

可以忽略的對話串：

- VM 對話串：這是一種 VM 系統對話串。
- 以 GC 任務對話串開始的對話串：這些是垃圾收集對話串。
- 程式碼 java.net.PlainSocketImpl.socketAccept(Native Method) 中名稱類似 - 1347028691218 的對話串：這些對話串來自等候新連線的 servlet 引擎的對話串池。
